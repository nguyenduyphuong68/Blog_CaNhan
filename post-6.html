<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bài 6: Đa tiến trình và Tuần tự hóa đối tượng</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        navy: {
                            50: '#f0f4f8',
                            100: '#d9e2ec',
                            200: '#bcccdc',
                            300: '#9fb3c8',
                            400: '#829ab1',
                            500: '#627d98',
                            600: '#486581',
                            700: '#334e68',
                            800: '#243b53',
                            900: '#102a43',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        code, pre {
            font-family: 'JetBrains Mono', monospace;
        }
        .post-content p {
            margin-bottom: 1.5rem;
            line-height: 1.75;
        }
        .post-content h2 {
            font-size: 1.875rem;
            font-weight: 700;
            color: #102a43;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        .post-content h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: #243b53;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
        }
        .post-content code {
            background-color: #f1f5f9;
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            font-size: 0.875em;
            color: #334e68;
        }
        .post-content pre {
            background-color: #1e293b;
            color: #e2e8f0;
            padding: 1.5rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin: 1.5rem 0;
        }
        .post-content pre code {
            background-color: transparent;
            padding: 0;
            color: inherit;
        }
        .post-content ul, .post-content ol {
            margin-left: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .post-content li {
            margin-bottom: 0.5rem;
        }
        .post-content a {
            color: #486581;
            text-decoration: underline;
        }
        .post-content a:hover {
            color: #102a43;
        }
    </style>
</head>
<body class="bg-white text-slate-900 antialiased">
    <nav class="fixed top-4 left-4 right-4 z-50 max-w-7xl mx-auto">
        <div class="bg-white/90 backdrop-blur-md border border-gray-200 rounded-lg shadow-sm px-6 py-3 flex items-center justify-between">
            <a href="index.html" class="text-xl font-semibold text-navy-900 cursor-pointer">I'm Phuong</a>
            <a href="index.html" class="text-slate-600 hover:text-navy-900 transition-colors duration-200 cursor-pointer flex items-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                </svg>
                Về trang chủ
            </a>
        </div>
    </nav>

    <main class="pt-32 pb-20 px-4">
        <div class="max-w-4xl mx-auto">
            <article>
                <header class="mb-8">
                    <div class="flex items-center gap-2 mb-4">
                        <a href="index.html" class="text-sm text-slate-500 hover:text-navy-900 transition-colors duration-200 cursor-pointer flex items-center gap-1">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                            </svg>
                            Về danh sách bài viết
                        </a>
                        <span class="text-slate-400">•</span>
                        <span class="text-sm text-slate-500 font-mono">22 tháng 12, 2025</span>
                    </div>
                    <h1 class="text-4xl md:text-5xl font-bold text-navy-900 mb-6 leading-tight">Bài 6: Đa tiến trình và Tuần tự hóa đối tượng</h1>
                    <div class="flex flex-wrap gap-2 mb-8">
                        <span class="px-3 py-1.5 bg-navy-50 text-navy-700 text-sm font-medium rounded-lg">Java Concurrency</span>
                        <span class="px-3 py-1.5 bg-navy-50 text-navy-700 text-sm font-medium rounded-lg">Serialization</span>
                        <span class="px-3 py-1.5 bg-navy-50 text-navy-700 text-sm font-medium rounded-lg">Network Programming</span>
                    </div>
                </header>

                <div class="post-content bg-white border border-gray-200 rounded-2xl shadow-sm p-8 md:p-12 prose prose-slate max-w-none">
                    <p>Nâng cấp Server đơn lẻ thành Server tương tranh có khả năng phục vụ hàng ngàn khách hàng đồng thời.</p>
                    
                    <h2>Server tương tranh (Concurrent Server)</h2>
                    <p>Server tương tranh quản lý mỗi phiên của client bằng một tuyến (thread) riêng biệt. Điều này cho phép server xử lý nhiều client đồng thời mà không bị chặn bởi một client duy nhất.</p>
                    
                    <h3>Kiến trúc Server tương tranh</h3>
                    <pre><code>import java.net.ServerSocket;
import java.net.Socket;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class ConcurrentServer {
    private static final int PORT = 12345;
    private static final int MAX_THREADS = 100;
    
    public static void main(String[] args) {
        ExecutorService threadPool = Executors.newFixedThreadPool(MAX_THREADS);
        
        try (ServerSocket serverSocket = new ServerSocket(PORT)) {
            System.out.println("Concurrent Server đang lắng nghe trên port " + PORT);
            
            while (true) {
                Socket clientSocket = serverSocket.accept();
                System.out.println("Client mới kết nối: " + 
                    clientSocket.getInetAddress());
                
                // Mỗi client được xử lý trong một thread riêng
                threadPool.submit(new ClientHandler(clientSocket));
            }
        } catch (IOException e) {
            System.err.println("Lỗi server: " + e.getMessage());
        } finally {
            threadPool.shutdown();
        }
    }
}</code></pre>
                    
                    <h2>Tuần tự hóa (Serialization)</h2>
                    <p>Tuần tự hóa là quá trình biến đổi đối tượng thành dãy byte để lưu trữ hoặc truyền đi qua mạng. Deserialization là quá trình ngược lại - khôi phục đối tượng từ dãy byte.</p>
                    
                    <h3>Cách triển khai</h3>
                    <p>Đối tượng cần truyền phải implement interface <code>Serializable</code>:</p>
                    <pre><code>import java.io.Serializable;

public class User implements Serializable {
    private static final long serialVersionUID = 1L;
    
    private String name;
    private int age;
    private String email;
    
    public User(String name, int age, String email) {
        this.name = name;
        this.age = age;
        this.email = email;
    }
    
    // Getters and setters
    public String getName() { return name; }
    public void setName(String name) { this.name = name; }
    
    public int getAge() { return age; }
    public void setAge(int age) { this.age = age; }
    
    public String getEmail() { return email; }
    public void setEmail(String email) { this.email = email; }
    
    @Override
    public String toString() {
        return "User{name='" + name + "', age=" + age + 
               ", email='" + email + "'}";
    }
}</code></pre>
                    
                    <h3>Luồng xử lý</h3>
                    <p>Dùng <code>ObjectOutputStream</code> để ghi đối tượng và <code>ObjectInputStream</code> để đọc đối tượng từ Socket:</p>
                    
                    <h4>Server gửi đối tượng</h4>
                    <pre><code>import java.io.*;
import java.net.Socket;

public class ServerSendObject {
    public static void main(String[] args) {
        try (ServerSocket serverSocket = new ServerSocket(12345);
             Socket clientSocket = serverSocket.accept();
             ObjectOutputStream oos = new ObjectOutputStream(
                 clientSocket.getOutputStream())) {
            
            // Tạo và gửi đối tượng
            User user = new User("Nguyễn Văn A", 25, "nguyenvana@example.com");
            oos.writeObject(user);
            oos.flush();
            System.out.println("Đã gửi đối tượng: " + user);
            
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}</code></pre>
                    
                    <h4>Client nhận đối tượng</h4>
                    <pre><code>import java.io.*;
import java.net.Socket;

public class ClientReceiveObject {
    public static void main(String[] args) {
        try (Socket socket = new Socket("localhost", 12345);
             ObjectInputStream ois = new ObjectInputStream(
                 socket.getInputStream())) {
            
            // Nhận đối tượng
            User user = (User) ois.readObject();
            System.out.println("Đã nhận đối tượng: " + user);
            
        } catch (IOException | ClassNotFoundException e) {
            e.printStackTrace();
        }
    }
}</code></pre>
                    
                    <h3>Ví dụ hoàn chỉnh: Server-Client với Serialization</h3>
                    <pre><code>import java.io.*;
import java.net.*;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

// Server
public class ObjectServer {
    private static final int PORT = 12345;
    
    public static void main(String[] args) {
        ExecutorService executor = Executors.newFixedThreadPool(10);
        
        try (ServerSocket serverSocket = new ServerSocket(PORT)) {
            System.out.println("Object Server đang lắng nghe...");
            
            while (true) {
                Socket clientSocket = serverSocket.accept();
                executor.submit(new ObjectHandler(clientSocket));
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    
    static class ObjectHandler implements Runnable {
        private Socket socket;
        
        public ObjectHandler(Socket socket) {
            this.socket = socket;
        }
        
        @Override
        public void run() {
            try (ObjectInputStream ois = new ObjectInputStream(
                    socket.getInputStream());
                 ObjectOutputStream oos = new ObjectOutputStream(
                     socket.getOutputStream())) {
                
                // Nhận đối tượng từ client
                User user = (User) ois.readObject();
                System.out.println("Nhận từ client: " + user);
                
                // Xử lý và gửi phản hồi
                user.setAge(user.getAge() + 1);
                oos.writeObject(user);
                oos.flush();
                
            } catch (IOException | ClassNotFoundException e) {
                e.printStackTrace();
            } finally {
                try {
                    socket.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }
    }
}

// Client
public class ObjectClient {
    public static void main(String[] args) {
        try (Socket socket = new Socket("localhost", 12345);
             ObjectOutputStream oos = new ObjectOutputStream(
                 socket.getOutputStream());
             ObjectInputStream ois = new ObjectInputStream(
                 socket.getInputStream())) {
            
            // Gửi đối tượng
            User user = new User("Trần Thị B", 30, "tranthib@example.com");
            oos.writeObject(user);
            oos.flush();
            
            // Nhận đối tượng đã xử lý
            User response = (User) ois.readObject();
            System.out.println("Nhận từ server: " + response);
            
        } catch (IOException | ClassNotFoundException e) {
            e.printStackTrace();
        }
    }
}</code></pre>
                    
                    <h2>Lưu ý về Serialization</h2>
                    <ul>
                        <li><strong>serialVersionUID</strong>: Nên khai báo để đảm bảo tương thích khi class thay đổi</li>
                        <li><strong>transient</strong>: Các field không cần serialize có thể đánh dấu là <code>transient</code></li>
                        <li><strong>Security</strong>: Serialization có thể có lỗ hổng bảo mật, cần cẩn thận với dữ liệu không tin cậy</li>
                        <li><strong>Performance</strong>: Serialization có thể chậm với đối tượng lớn, xem xét các giải pháp thay thế như JSON, Protocol Buffers</li>
                    </ul>
                    
                    <h2>Best Practices</h2>
                    <ul>
                        <li>Sử dụng thread pool để quản lý tài nguyên hiệu quả</li>
                        <li>Luôn đóng stream và socket đúng cách</li>
                        <li>Xử lý exceptions một cách phù hợp</li>
                        <li>Xem xét sử dụng JSON hoặc Protocol Buffers thay vì Java Serialization cho các ứng dụng cross-platform</li>
                        <li>Giới hạn số lượng thread để tránh quá tải hệ thống</li>
                    </ul>
                </div>

                <footer class="mt-12 pt-8 border-t border-gray-200">
                    <div class="flex items-center">
                        <a href="index.html" class="inline-flex items-center gap-2 px-6 py-3 bg-navy-900 text-white rounded-lg hover:bg-navy-800 transition-colors duration-200 cursor-pointer">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                            </svg>
                            Về tất cả bài viết
                        </a>
                    </div>
                </footer>
            </article>
        </div>
    </main>

    <footer class="border-t border-gray-200 py-8 px-4 bg-slate-50">
        <div class="max-w-6xl mx-auto">
            <div class="text-center mb-6">
                <h3 class="text-lg font-semibold text-navy-900 mb-4">Thông tin liên hệ</h3>
                <div class="flex flex-col md:flex-row items-center justify-center gap-4 md:gap-6 text-slate-600">
                    <!-- Phone -->
                    <a href="tel:+84911917763" class="inline-flex items-center gap-2 hover:text-navy-900 transition-colors duration-200">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                        </svg>
                        <span>(+84)911917763</span>
                    </a>
                    
                    <!-- Email -->
                    <a href="mailto:nguyenphuong682004@gmail.com" class="inline-flex items-center gap-2 hover:text-navy-900 transition-colors duration-200">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                        </svg>
                        <span>nguyenphuong682004@gmail.com</span>
                    </a>
                    
                    <!-- Facebook -->
                    <a href="https://www.facebook.com/Phu0nggggg" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 hover:text-navy-900 transition-colors duration-200">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                        </svg>
                        <span>Facebook</span>
                    </a>
                    
                    <!-- Instagram -->
                    <a href="https://www.instagram.com/d.phu0ng/" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 hover:text-navy-900 transition-colors duration-200">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                        </svg>
                        <span>Instagram</span>
                    </a>
                </div>
            </div>
        </div>
    </footer>
</body>
</html>
